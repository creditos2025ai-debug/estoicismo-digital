<!DOCTYPE html>
<html class="light" lang="es">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Progreso - Estoicismo Digital</title>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
<link href="https://fonts.googleapis.com/css2?family=Newsreader:ital,opsz,wght@0,6..72,200..800;1,6..72,200..800&amp;family=Inter:wght@400;500;700&amp;display=swap" rel="stylesheet"/>
<script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            primary: "#6B7A6A",
            "background-light": "#F8F8F4",
            "background-dark": "#1A1A18",
            "surface-light": "#FFFFFF",
            "surface-dark": "#2C2C2A",
            "text-light-primary": "#333333",
            "text-dark-primary": "#E0E0DC",
            "text-light-secondary": "#6B7A6A",
            "text-dark-secondary": "#A3B8A2",
            "border-light": "#EAEAE0",
            "border-dark": "#3D3D3A",
          },
          fontFamily: {
            display: ["Newsreader", "serif"],
            sans: ["Inter", "sans-serif"],
          },
          borderRadius: {
            DEFAULT: "0.75rem",
          },
        },
      },
    };
  </script>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-sans">
<div class="container mx-auto max-w-md p-4 pb-24">
<header class="flex items-center mb-6 pt-4">
<a href="index.html" class="text-text-light-secondary dark:text-text-dark-secondary p-2 hover:bg-surface-light dark:hover:bg-surface-dark rounded-full transition-colors">
<span class="material-icons">arrow_back</span>
</a>
<h1 class="text-2xl font-bold text-text-light-primary dark:text-text-dark-primary font-display flex-1 text-center">Tu Camino</h1>
<div class="w-10"></div>
</header>

<!-- Calendar -->
<section class="mb-6">
<div class="bg-surface-light dark:bg-surface-dark p-4 rounded-2xl border border-border-light dark:border-border-dark">
<div class="flex items-center justify-between mb-4 px-2">
<button onclick="previousMonth()" class="p-2 hover:bg-background-light dark:hover:bg-background-dark rounded-full transition-colors">
<span class="material-icons text-text-light-secondary dark:text-text-dark-secondary">chevron_left</span>
</button>
<p class="font-display text-lg font-bold text-text-light-primary dark:text-text-dark-primary" id="current-month">Octubre 2025</p>
<button onclick="nextMonth()" class="p-2 hover:bg-background-light dark:hover:bg-background-dark rounded-full transition-colors">
<span class="material-icons text-text-light-secondary dark:text-text-dark-secondary">chevron_right</span>
</button>
</div>
<div class="grid grid-cols-7 gap-1">
<div class="text-xs font-bold text-center text-text-light-secondary dark:text-text-dark-secondary pb-2">D</div>
<div class="text-xs font-bold text-center text-text-light-secondary dark:text-text-dark-secondary pb-2">L</div>
<div class="text-xs font-bold text-center text-text-light-secondary dark:text-text-dark-secondary pb-2">M</div>
<div class="text-xs font-bold text-center text-text-light-secondary dark:text-text-dark-secondary pb-2">X</div>
<div class="text-xs font-bold text-center text-text-light-secondary dark:text-text-dark-secondary pb-2">J</div>
<div class="text-xs font-bold text-center text-text-light-secondary dark:text-text-dark-secondary pb-2">V</div>
<div class="text-xs font-bold text-center text-text-light-secondary dark:text-text-dark-secondary pb-2">S</div>
<div id="calendar-days" class="col-span-7 grid grid-cols-7 gap-1">
<!-- Days will be generated by JavaScript -->
</div>
</div>
</div>
</section>

<!-- Streak Info -->
<p class="text-base font-medium text-center mb-8 text-text-light-primary dark:text-text-dark-primary">
Racha de Diario: <span class="text-primary font-bold text-xl" id="streak-display">0 días</span>
</p>

<!-- Stats -->
<section class="mb-8">
<h2 class="text-2xl font-bold mb-4 text-text-light-primary dark:text-text-dark-primary font-display">Estadísticas</h2>
<div class="grid grid-cols-2 gap-4">
<div class="bg-surface-light dark:bg-surface-dark p-5 rounded-xl border border-border-light dark:border-border-dark">
<p class="text-sm text-text-light-secondary dark:text-text-dark-secondary mb-2">Ejercicios Completados</p>
<p class="font-display text-4xl font-bold text-primary" id="exercises-count">0</p>
</div>
<div class="bg-surface-light dark:bg-surface-dark p-5 rounded-xl border border-border-light dark:border-border-dark">
<p class="text-sm text-text-light-secondary dark:text-text-dark-secondary mb-2">Entradas de Diario</p>
<p class="font-display text-4xl font-bold text-primary" id="journal-count">0</p>
</div>
<div class="bg-surface-light dark:bg-surface-dark p-5 rounded-xl border border-border-light dark:border-border-dark">
<p class="text-sm text-text-light-secondary dark:text-text-dark-secondary mb-2">Días Activos</p>
<p class="font-display text-4xl font-bold text-primary" id="active-days">0</p>
</div>
<div class="bg-surface-light dark:bg-surface-dark p-5 rounded-xl border border-border-light dark:border-border-dark">
<p class="text-sm text-text-light-secondary dark:text-text-dark-secondary mb-2">Racha Máxima</p>
<p class="font-display text-4xl font-bold text-primary" id="max-streak">0</p>
</div>
</div>
</section>

<!-- Activity Graph -->
<section class="mb-8">
<h2 class="text-2xl font-bold mb-4 text-text-light-primary dark:text-text-dark-primary font-display">Actividad Reciente</h2>
<div class="bg-surface-light dark:bg-surface-dark p-4 rounded-xl border border-border-light dark:border-border-dark">
<div class="space-y-3" id="activity-list">
<p class="text-center text-text-light-secondary dark:text-text-dark-secondary text-sm">Cargando actividad...</p>
</div>
</div>
</section>

<!-- Motivational Card -->
<section class="mb-8">
<div class="bg-surface-light dark:bg-surface-dark rounded-2xl overflow-hidden border border-border-light dark:border-border-dark">
<div class="w-full h-32 bg-gradient-to-br from-primary/30 to-primary/10"></div>
<div class="p-6">
<p class="font-display text-xl italic text-text-light-primary dark:text-text-dark-primary mb-3">"La felicidad de tu vida depende de la calidad de tus pensamientos."</p>
<p class="text-sm text-text-light-secondary dark:text-text-dark-secondary">— Marco Aurelio</p>
</div>
</div>
</section>
</div>

<!-- Bottom Navigation -->
<footer class="fixed bottom-0 left-0 right-0 bg-background-light dark:bg-background-dark border-t border-border-light dark:border-border-dark">
<nav class="container mx-auto max-w-md flex justify-around items-center h-20">
<a class="flex flex-col items-center text-text-light-secondary dark:text-text-dark-secondary" href="index.html">
<span class="material-icons">home</span>
<span class="text-xs">Inicio</span>
</a>
<a class="flex flex-col items-center text-text-light-secondary dark:text-text-dark-secondary" href="learn.html">
<span class="material-icons">book</span>
<span class="text-xs">Aprender</span>
</a>
<a class="flex flex-col items-center text-text-light-secondary dark:text-text-dark-secondary" href="practice.html">
<span class="material-icons">psychology</span>
<span class="text-xs">Practicar</span>
</a>
<a class="flex flex-col items-center text-text-light-secondary dark:text-text-dark-secondary" href="agenda.html">
<span class="material-icons">event_note</span>
<span class="text-xs">Agenda</span>
</a>
<a class="flex flex-col items-center text-text-light-secondary dark:text-text-dark-secondary" href="journal.html">
<span class="material-icons">edit_note</span>
<span class="text-xs">Diario</span>
</a>
<a class="flex flex-col items-center text-primary" href="progress.html">
<span class="material-icons">trending_up</span>
<span class="text-xs font-bold">Progreso</span>
</a>
</nav>
</footer>

<script src="js/app.js"></script>
<script>
let currentMonth = new Date().getMonth();
let currentYear = new Date().getFullYear();

document.addEventListener('DOMContentLoaded', () => {
  renderCalendar();
  loadStats();
  loadActivity();
});

function renderCalendar() {
  const monthNames = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 
                      'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
  
  document.getElementById('current-month').textContent = `${monthNames[currentMonth]} ${currentYear}`;
  
  const firstDay = new Date(currentYear, currentMonth, 1).getDay();
  const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
  
  const entries = JSON.parse(localStorage.getItem('journalEntries') || '[]');
  const entryDates = entries.map(e => new Date(e.date).toDateString());
  
  let daysHTML = '';
  
  // Empty cells for days before month starts
  for (let i = 0; i < firstDay; i++) {
    daysHTML += '<div></div>';
  }
  
  // Days of the month
  for (let day = 1; day <= daysInMonth; day++) {
    const date = new Date(currentYear, currentMonth, day);
    const dateString = date.toDateString();
    const hasEntry = entryDates.includes(dateString);
    const isToday = date.toDateString() === new Date().toDateString();
    
    let className = 'aspect-square flex items-center justify-center rounded-full text-sm font-medium';
    
    if (isToday) {
      className += ' bg-primary text-white ring-2 ring-primary/50';
    } else if (hasEntry) {
      className += ' bg-primary/20 dark:bg-primary/30 text-text-light-primary dark:text-text-dark-primary';
    } else {
      className += ' text-text-light-primary dark:text-text-dark-primary';
    }
    
    daysHTML += `<div class="${className}">${day}</div>`;
  }
  
  document.getElementById('calendar-days').innerHTML = daysHTML;
}

function previousMonth() {
  currentMonth--;
  if (currentMonth < 0) {
    currentMonth = 11;
    currentYear--;
  }
  renderCalendar();
}

function nextMonth() {
  currentMonth++;
  if (currentMonth > 11) {
    currentMonth = 0;
    currentYear++;
  }
  renderCalendar();
}

function loadStats() {
  const entries = JSON.parse(localStorage.getItem('journalEntries') || '[]');
  const exercises = JSON.parse(localStorage.getItem('controlExercises') || '[]');
  
  // Count entries
  document.getElementById('journal-count').textContent = entries.length;
  document.getElementById('exercises-count').textContent = exercises.length;
  
  // Calculate active days
  const uniqueDates = new Set(entries.map(e => new Date(e.date).toDateString()));
  document.getElementById('active-days').textContent = uniqueDates.size;
  
  // Calculate streaks
  const currentStreak = calculateStreak(entries);
  const maxStreak = calculateMaxStreak(entries);
  
  document.getElementById('streak-display').textContent = `${currentStreak} día${currentStreak !== 1 ? 's' : ''}`;
  document.getElementById('max-streak').textContent = maxStreak;
}

function calculateStreak(entries) {
  if (entries.length === 0) return 0;
  
  const sortedEntries = entries.sort((a, b) => new Date(b.date) - new Date(a.date));
  const dates = [...new Set(sortedEntries.map(e => new Date(e.date).toDateString()))];
  
  let streak = 0;
  let currentDate = new Date();
  currentDate.setHours(0, 0, 0, 0);
  
  for (let dateString of dates) {
    const entryDate = new Date(dateString);
    const diffDays = Math.floor((currentDate - entryDate) / (1000 * 60 * 60 * 24));
    
    if (diffDays === streak) {
      streak++;
      currentDate.setDate(currentDate.getDate() - 1);
    } else if (diffDays > streak) {
      break;
    }
  }
  
  return streak;
}

function calculateMaxStreak(entries) {
  if (entries.length === 0) return 0;
  
  const dates = [...new Set(entries.map(e => new Date(e.date).toDateString()))].sort();
  
  let maxStreak = 1;
  let currentStreak = 1;
  
  for (let i = 1; i < dates.length; i++) {
    const prevDate = new Date(dates[i - 1]);
    const currDate = new Date(dates[i]);
    const diffDays = Math.floor((currDate - prevDate) / (1000 * 60 * 60 * 24));
    
    if (diffDays === 1) {
      currentStreak++;
      maxStreak = Math.max(maxStreak, currentStreak);
    } else {
      currentStreak = 1;
    }
  }
  
  return maxStreak;
}

function loadActivity() {
  const entries = JSON.parse(localStorage.getItem('journalEntries') || '[]');
  const exercises = JSON.parse(localStorage.getItem('controlExercises') || '[]');
  
  const allActivities = [
    ...entries.map(e => ({ ...e, activityType: 'journal' })),
    ...exercises.map(e => ({ ...e, activityType: 'exercise' }))
  ].sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 10);
  
  const container = document.getElementById('activity-list');
  
  if (allActivities.length === 0) {
    container.innerHTML = '<p class="text-center text-text-light-secondary dark:text-text-dark-secondary text-sm">No hay actividad registrada aún.</p>';
    return;
  }
  
  container.innerHTML = allActivities.map(activity => {
    const icon = activity.activityType === 'journal' ? 'edit_note' : 'psychology';
    const typeText = activity.activityType === 'journal' ? 'Entrada de diario' : 'Ejercicio de control';
    
    return `
      <div class="flex items-center gap-3 py-2 border-b border-border-light dark:border-border-dark last:border-0">
        <div class="w-10 h-10 bg-primary/20 dark:bg-primary/30 rounded-full flex items-center justify-center shrink-0">
          <span class="material-icons text-primary text-sm">${icon}</span>
        </div>
        <div class="flex-1 min-w-0">
          <p class="text-sm font-medium text-text-light-primary dark:text-text-dark-primary truncate">${activity.title || typeText}</p>
          <p class="text-xs text-text-light-secondary dark:text-text-dark-secondary">${formatDate(activity.date)}</p>
        </div>
      </div>
    `;
  }).join('');
}

function formatDate(dateString) {
  const date = new Date(dateString);
  const now = new Date();
  const diffMs = now - date;
  const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
  
  if (diffDays === 0) return 'Hoy';
  if (diffDays === 1) return 'Ayer';
  if (diffDays < 7) return `Hace ${diffDays} días`;
  
  const options = { day: 'numeric', month: 'short' };
  return date.toLocaleDateString('es-ES', options);
}
</script>
</body>
</html>

